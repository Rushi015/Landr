generator client {
  provider = "prisma-client-js"
  output   = "../src/generated/prisma"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

enum Plan {
  BASE
  UNLIMITED
}

model User {
  id          Int        @id @default(autoincrement())
  email       String     @unique
  name        String
  password    String
  userName    String
  isVerified  Boolean    @default(false)
  createdAt   DateTime   @default(now())
  workspaceId String?
  workspace   WorkSpace? @relation(fields: [workspaceId], references: [id])
}

model WorkSpace {
  id            String         @id @default(uuid())
  createdAt     DateTime       @default(now())
  updatedAt     DateTime       @updatedAt
  name          String
  companyEmail  String
  companyPhone  String

  users         User[]
  projects      Project[]
  subscription  Subscription?
}

model Project {
  id          String     @id @default(uuid())
  createdAt   DateTime   @default(now())
  updatedAt   DateTime   @updatedAt
  name        String
  companyEmail String
  companyPhone String

  workspaceId String
  workspace   WorkSpace @relation(fields: [workspaceId], references: [id])

  @@index([workspaceId])
}

model Subscription {
  id                  String     @id @default(uuid())
  createdAt           DateTime   @default(now())
  updatedAt           DateTime   @updatedAt
  plan                Plan?
  price               String?
  active              Boolean    @default(false)
  priceId             String
  customerId          String
  currentPeriodEndDate DateTime
  subscriptionId      String     @unique
  workspaceId         String?    @unique
  workspace           WorkSpace? @relation(fields: [workspaceId], references: [id])

  @@index([customerId])
}
